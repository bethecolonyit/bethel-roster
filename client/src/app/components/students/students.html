<div class="students-page">
  <mat-card class="students-card">
    <mat-card-header>
      <div mat-card-avatar class="students-avatar">
        <mat-icon>school</mat-icon>
      </div>

      <mat-card-title>Student Dashboard</mat-card-title>
      <mat-card-subtitle>View and manage enrolled students</mat-card-subtitle>
      
      <span class="flex-spacer"></span>

      <!-- View toggle button -->
      <button
        mat-icon-button
        color="primary"
        (click)="toggleViewMode()"
        [attr.aria-label]="viewMode === 'grid' ? 'Switch to list view' : 'Switch to grid view'"
      >
        <mat-icon>
          {{ viewMode === 'grid' ? 'view_list' : 'grid_view' }}
        </mat-icon>
      </button>

      <!-- + / close button -->
      <button
        mat-icon-button
        color="primary"
        type="button"
        (click)="toggleCreateStudent()"
        [attr.aria-label]="showCreateForm ? 'Hide create student form' : 'Show create student form'"
      >
        <mat-icon>{{ showCreateForm ? 'close' : 'add' }}</mat-icon>
      </button>
      <!-- Search box -->
      <mat-form-field
        class="students-search"
        appearance="outline"
      >
        <mat-icon matPrefix>search</mat-icon>
        <input
          matInput
          placeholder="Search by name or file #"
          [(ngModel)]="searchTerm"
          (ngModelChange)="onSearchTermChange($event)"
        />
      </mat-form-field>
    </mat-card-header>

    <mat-card-content>

      <!-- Create student form -->
      <div *ngIf="showCreateForm" class="create-student-section">
        <app-create-student (studentCreated)="onStudentCreated()"></app-create-student>
      </div>

      <!-- Error -->
      <div *ngIf="error" class="error-message">
        <mat-icon>error_outline</mat-icon>
        <span>{{ error }}</span>
      </div>

      <!-- GRID VIEW -->
      <div class="grid-container" *ngIf="viewMode === 'grid' && filteredStudents.length > 0">
        <app-student-card
          *ngFor="let student of filteredStudents"
          [student]="student"
          (viewDetails)="onViewStudentDetails($event)"
          (createNote)="onCreateStudentNote($event)"
          (createWriteUp)="onCreateStudentWriteUp($event)"
        ></app-student-card>
</div>

      <!-- LIST VIEW -->
      <app-student-list
        *ngIf="viewMode === 'list'"
        [students]="filteredStudents"
        [viewMode]="viewMode"
      ></app-student-list>

      <!-- Empty state -->
      <div class="empty-state" *ngIf="students.length === 0">
        <mat-icon>info</mat-icon>
        <span>No students found.</span>
      </div>

    </mat-card-content>
  </mat-card>
</div>
